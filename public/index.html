<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fluffy Favourites Slot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, sans-serif; background:#111; color:#eee; margin:0; display:flex; flex-direction:column; align-items:center; }
    header { padding:1rem 0; }
  #gameBoard { position:relative; width:900px; height:600px; background:url('./symbols/background.jpg') center/contain no-repeat; display:flex; align-items:center; justify-content:center; }
  /* Reel area sized same as previous slot box; adjust offset to sit inside white space of background image */
  #slot { width:530px; height:312px; position:absolute; /* tuned offsets; adjust if needed */ top:140px; left:185px; }
  #reelBack { position:absolute; inset:0; background:rgba(255,255,255,0.95); border:2px solid #333; border-radius:12px; box-shadow:inset 0 0 10px rgba(0,0,0,.25); }
  #lineOverlay { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; overflow:visible; }
  .cell { width:100px; height:100px; background:transparent; border:none; border-radius:0; display:flex; align-items:center; justify-content:center; position:absolute; top:0; left:0; pointer-events:none; }
  .cell.anticipate { border-color:#ff9800; box-shadow:0 0 12px 4px rgba(255,152,0,.65), inset 0 0 6px rgba(0,0,0,.25); animation:pulseGlow 1s ease-in-out infinite; }
  @keyframes pulseGlow { 0%,100% { filter:brightness(1); } 50% { filter:brightness(1.3); } }
    .cell.win { border-color:#4caf50; box-shadow:0 0 8px #4caf50; }
    @keyframes flicker { 0%,100% { filter:brightness(1);} 50% { filter:brightness(1.6);} }
    .cell.spinning { animation:flicker .5s linear infinite; }
    .symbol-img { width:100%; height:100%; object-fit:contain; }
    #controls { display:flex; gap:1rem; align-items:center; }
    button { background:#ff4fa3; color:#fff; border:none; padding:.75rem 1.25rem; border-radius:6px; font-size:1rem; cursor:pointer; font-weight:600; }
    button:disabled { opacity:.4; cursor:default; }
    #log { max-width:600px; font-size:.85rem; line-height:1.4; background:#181818; padding:1rem; border-radius:8px; height:140px; overflow:auto; }
    .stat-bar { display:flex; gap:2rem; flex-wrap:wrap; font-size:.9rem; }
    .fs-banner { background:#673ab7; padding:.4rem .8rem; border-radius:4px; margin-left:1rem; display:none; }
    .fs-banner.active { display:inline-block; }
  </style>
</head>
<body>
  <header>
    <div style="display:flex; align-items:center; gap:1.5rem;">
      <div id="balancePanel" style="background:#fff; color:#111; padding:.5rem .9rem; border-radius:6px; font-weight:600; min-width:110px; text-align:center; box-shadow:0 0 6px rgba(0,0,0,.35);">£<span id="balance">100.00</span></div>
      <h1 style="margin:0; font-size:1.35rem;">Fluffy Favourites Slot <span id="fsState" class="fs-banner">Free Spins: <span id="fsRemain"></span></span></h1>
    </div>
  </header>
  <div id="gameBoard">
    <div id="slot"><div id="reelBack"></div></div>
    <svg id="lineOverlay" style="position:absolute; top:140px; left:185px; width:530px; height:312px;"></svg>
  </div>
  <div id="controls">
  <!-- Bet input removed: fixed stake £1 total -->
    <button id="spinBtn">Spin</button>
    <button id="autoBtn">Auto (50)</button>
    <button id="forceFSBtn" title="Force Free Spins">Force FS</button>
    <button id="forceBonusBtn" title="Force Bonus Pick">Force Bonus</button>
    <div>Total Win: <strong id="lastWin">0</strong></div>
  </div>
  <!-- Bonus Pick Modal -->
  <div id="pickModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.7); align-items:center; justify-content:center; z-index:1000;">
    <div style="background:#222; padding:1rem 1.5rem; border-radius:12px; width:420px; max-width:90%; box-shadow:0 0 18px rgba(0,0,0,.6);">
      <h2 style="margin-top:0;">Bonus Pick <small id="pickInfo" style="font-size:.7em; opacity:.7;"></small></h2>
      <div id="pickGrid" style="display:grid; grid-template-columns:repeat(3,1fr); gap:.75rem; margin:.75rem 0;"></div>
      <div id="pickSummary" style="min-height:1.2em; font-size:.9rem; margin:.5rem 0 .75rem;"></div>
      <div style="display:flex; justify-content:space-between;">
        <button id="pickCloseBtn" style="background:#444;">Close</button>
        <button id="pickRevealRestBtn" style="background:#ff4fa3;">Reveal Remaining</button>
      </div>
    </div>
  </div>
  <div class="stat-bar">
    <div>Balance: <span id="balance">10000</span></div>
    <div>RTP (session): <span id="rtp">--</span></div>
    <div>Spins: <span id="spins">0</span></div>
  </div>
  <h3>Log</h3>
  <div id="log"></div>
  <!-- Winners Panel -->
  <div id="bonusWinPanel" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.65); align-items:center; justify-content:center; z-index:1100;">
    <div style="background:#1c1c1c; padding:1.2rem 1.6rem; border-radius:16px; width:440px; max-width:92%; text-align:center; box-shadow:0 0 22px rgba(0,0,0,.7);">
      <h2 style="margin:0 0 .5rem;">Bonus Complete!</h2>
      <p id="bonusWinDetails" style="font-size:1rem; line-height:1.4; margin:.25rem 0 .75rem;"></p>
      <p style="font-size:.75rem; opacity:.6;">Panel will close automatically…</p>
      <button id="bonusWinCloseBtn" style="margin-top:.6rem; background:#ff4fa3; padding:.6rem 1.2rem; border-radius:8px; font-weight:600;">Close Now</button>
    </div>
  </div>
  <script type="module" src="/src/web/main.ts"></script>
</body>
</html>